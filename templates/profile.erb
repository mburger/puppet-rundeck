export RDECK_HOME=<%= @rd_home %>
export RDECK_BASE=<%= @rd_home %>
export JUMIO_BASE=<%= @rd_base %>

JAVA_CMD=java
RUNDECK_TEMPDIR=${JUMIO_BASE}/tmp

JAVA_HOME=/jumio/app/jre

if [ ! -z $JAVA_HOME ]; then
  export PATH=${PATH}:${JAVA_HOME}/bin
  JAVA_CMD=${JAVA_HOME}/bin/java
fi

export CLI_CP=$(find /var/lib/rundeck/cli -name \*.jar -printf %p:)
export BOOTSTRAP_CP=$(find /var/lib/rundeck/bootstrap -name \*.jar -printf %p:)
export RDECK_JVM="-Djava.security.auth.login.config=${RDECK_BASE}/<%= @login_config %>\
	-Dloginmodule.name=<%= @login_module_name %> \
	-Drdeck.config=${RDECK_BASE} \
	-Drdeck.base=${RDECK_BASE} \
	-Drundeck.server.configDir=${RDECK_BASE} \
	-Drundeck.server.serverDir=/var/lib/rundeck \
	-Dserver.datastore.path=${JUMIO_BASE}/data \
	-Drdeck.projects=${JUMIO_BASE}/projects \
	-Drdeck.runlogs=${JUMIO_BASE}/logs \
	-Drundeck.config.location=${RDECK_BASE}/<%= @rd_config_property %> \
	-Djava.io.tmpdir=$RUNDECK_TEMPDIR"

#
# Set min/max heap size
#
RDECK_JVM="$RDECK_JVM -Xms<%= @xms %> -Xmx<%= @xmx %>"

export RDECK_SSL_OPTS="-Djavax.net.ssl.trustStore=/jumio/pki/cacerts"

if test -t 0 -a -z "$RUNDECK_CLI_TERSE"
then
  RUNDECK_CLI_TERSE=true
  export RUNDECK_CLI_TERSE
fi

if test -n "$JRE_HOME"
then
   unset JRE_HOME
fi

umask 002
